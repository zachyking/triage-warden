# Malware detection test cases for Triage Warden evaluation
# Contains true positive and false positive cases

# TRUE POSITIVE: Ransomware behavior detected
- id: malware_001
  name: "Ransomware encryption activity detected"
  alert:
    type: endpoint_detection
    hostname: "WORKSTATION-042"
    username: "jsmith"
    process_name: "suspicious.exe"
    process_path: "C:\\Users\\jsmith\\AppData\\Local\\Temp\\suspicious.exe"
    process_hash: "d41d8cd98f00b204e9800998ecf8427e"
    parent_process: "outlook.exe"
    command_line: "suspicious.exe --encrypt --target=C:\\Users"
    behaviors:
      - "Mass file modification detected"
      - "Shadow copy deletion attempted"
      - "Ransom note dropped in multiple directories"
    file_operations:
      - operation: "modify"
        path: "C:\\Users\\jsmith\\Documents\\*.docx"
        count: 150
      - operation: "create"
        path: "C:\\Users\\jsmith\\Documents\\README_DECRYPT.txt"
    network_connections:
      - destination: "185.141.25.68"
        port: 443
        protocol: "tcp"
    timestamp: "2024-01-15T11:45:00Z"
  expected:
    verdict: malicious
    severity: critical
    techniques: [T1486, T1490, T1059.001]

# FALSE POSITIVE: Legitimate backup software behavior
- id: malware_002
  name: "Backup software mass file operations"
  alert:
    type: endpoint_detection
    hostname: "FILESERVER-01"
    username: "SYSTEM"
    process_name: "BackupExec.exe"
    process_path: "C:\\Program Files\\Veritas\\Backup Exec\\BackupExec.exe"
    process_hash: "abc123def456789012345678901234ab"
    parent_process: "services.exe"
    command_line: "BackupExec.exe /backup /full"
    behaviors:
      - "Mass file read operations"
      - "Large data transfer to network location"
    file_operations:
      - operation: "read"
        path: "C:\\SharedData\\**\\*"
        count: 10000
    network_connections:
      - destination: "10.0.0.100"
        port: 445
        protocol: "tcp"
    signed: true
    signer: "Veritas Technologies LLC"
    timestamp: "2024-01-15T02:00:00Z"
  expected:
    verdict: benign
    severity: informational
    techniques: []

# TRUE POSITIVE: Cobalt Strike beacon detected
- id: malware_003
  name: "Cobalt Strike beacon communication"
  alert:
    type: endpoint_detection
    hostname: "WORKSTATION-108"
    username: "admin.service"
    process_name: "rundll32.exe"
    process_path: "C:\\Windows\\System32\\rundll32.exe"
    process_hash: "1a2b3c4d5e6f789012345678901234cd"
    parent_process: "powershell.exe"
    command_line: "rundll32.exe C:\\Users\\Public\\payload.dll,Start"
    behaviors:
      - "Reflective DLL injection detected"
      - "Named pipe communication"
      - "Periodic beaconing to C2"
    network_connections:
      - destination: "cdn.malicious-domain.com"
        port: 443
        protocol: "tcp"
        bytes_sent: 1024
        bytes_received: 2048
        interval: "60s"
    memory_artifacts:
      - "Cobalt Strike configuration block detected"
      - "Sleep mask function identified"
    timestamp: "2024-01-15T16:30:00Z"
  expected:
    verdict: malicious
    severity: critical
    techniques: [T1055.001, T1071.001, T1573.002]

# FALSE POSITIVE: Development tool triggering heuristics
- id: malware_004
  name: "Developer IDE compiling and debugging"
  alert:
    type: endpoint_detection
    hostname: "DEV-WORKSTATION-05"
    username: "developer.alice"
    process_name: "devenv.exe"
    process_path: "C:\\Program Files\\Microsoft Visual Studio\\2022\\Enterprise\\Common7\\IDE\\devenv.exe"
    process_hash: "validhash12345678901234567890abcd"
    parent_process: "explorer.exe"
    command_line: "devenv.exe /build Debug MyProject.sln"
    behaviors:
      - "Process injection detected"
      - "Memory manipulation"
      - "Code compilation"
    child_processes:
      - name: "msbuild.exe"
        path: "C:\\Program Files\\Microsoft Visual Studio\\2022\\Enterprise\\MSBuild\\Current\\Bin\\MSBuild.exe"
      - name: "vctip.exe"
        path: "C:\\Program Files\\Microsoft Visual Studio\\2022\\Enterprise\\VC\\Tools\\MSVC\\14.35.32215\\bin\\Hostx64\\x64\\vctip.exe"
    signed: true
    signer: "Microsoft Corporation"
    timestamp: "2024-01-15T10:15:00Z"
  expected:
    verdict: benign
    severity: low
    techniques: []
